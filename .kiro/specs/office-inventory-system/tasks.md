# 实施计划

- [ ] 1. 前端项目初始化和基础架构
  - 初始化React + TypeScript项目
  - 配置Ant Design UI组件库
  - 设置路由和状态管理（React Router + Context API）
  - 创建基础的布局组件和导航
  - _需求: 7.1_

- [-] 2. 物品管理前端页面
  - [x] 2.1 实现物品列表页面
    - 创建物品列表展示组件
    - 实现物品搜索和过滤功能
    - 添加物品的增删改操作界面
    - 使用模拟数据进行界面开发
    - _需求: 1.1, 1.2, 1.3, 1.4_
  
  - [ ] 2.2 实现库房位置管理页面
    - 创建库房位置列表和编辑组件
    - 实现位置层级结构显示和管理
    - 添加位置与物品关联设置界面
    - 使用模拟数据进行界面开发
    - _需求: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_

  - [ ] 2.3 实现批量导入页面
    - 创建Excel文件上传组件（支持库房位置字段）
    - 实现导入进度显示和结果反馈
    - 添加模板下载功能（包含位置信息）
    - 使用模拟数据测试界面
    - _需求: 6.1, 6.2, 6.4, 6.5_

- [x] 3. 出入库管理前端页面
  - [x] 3.1 实现出入库操作页面
    - 创建单个出入库操作表单（包含库房位置选择）
    - 实现物品选择和按位置库存检查界面
    - 添加位置库存实时显示功能
    - 添加操作历史记录展示（包含位置信息）
    - 使用模拟数据进行开发
    - _需求: 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 3.4, 3.5_
  
  - [x] 3.2 实现批量出入库页面
    - 创建批量操作的Excel上传界面（支持位置字段）
    - 实现批量操作结果的详细展示（包含位置信息）
    - 添加位置库存验证和错误处理界面
    - 添加错误处理和重试机制界面
    - 使用模拟数据测试功能
    - _需求: 2.6, 2.7, 3.6, 3.7_

- [x] 4. 库存查询前端页面
  - [x] 4.1 实现库存总览页面
    - 创建按位置分组的库存状态展示组件
    - 实现库存搜索和过滤界面（支持位置筛选）
    - 添加按位置的低库存预警显示
    - 实现位置库存汇总和详细视图切换
    - 使用模拟数据展示效果
    - _需求: 4.1, 4.2, 4.3, 4.5_
  
  - [x] 4.2 实现库存详情页面
    - 创建单个物品的库存详情页面（按位置分布显示）
    - 实现出入库历史记录展示（包含位置信息）
    - 添加按位置的库存变化趋势图表
    - 实现位置间库存分布可视化
    - 使用模拟数据进行开发
    - _需求: 4.4_
    - [ ] 5. 报表统计前端页面
  - [x] 5.1 实现统计报表页面
    - 创建月度统计和使用排行展示
    - 实现时间范围选择功能
    - 添加图表展示（使用Chart.js或类似库）
    - 使用模拟数据展示图表效果
    - _需求: 5.1, 5.2, 5.4_
  
  - [x] 5.2 实现报表导出功能
    - 创建报表导出界面
    - 实现CSV文件下载功能
    - 添加导出进度和状态提示
    - 使用模拟数据测试导出
    - _需求: 5.3_

- [ ] 6. 用户认证前端页面
  - 创建登录页面和认证状态管理
  - 实现路由权限保护
  - 添加用户角色显示和权限提示
  - 使用模拟认证数据进行开发
  - _需求: 8.1, 8.2, 8.4_

- [x] 7. 后端项目初始化和数据库设计
  - [x] 7.1 创建Node.js项目结构
    - 初始化Node.js + Express + TypeScript项目
    - 配置开发和生产环境的配置文件
    - 设置项目目录结构和基础中间件
    - _需求: 7.3_
  
  - [x] 7.2 数据库设计和初始化
    - 编写PostgreSQL数据库表创建脚本（items, locations, transactions, users表）
    - 创建支持位置的库存视图（inventory_view）和必要的索引
    - 实现数据库迁移和种子数据功能（包含示例位置数据）
    - 配置PostgreSQL连接池和环境变量管理
    - _需求: 1.1, 1.2, 2.1, 3.1, 7.1, 8.1_

- [x] 8. 核心数据模型和验证
  - [x] 8.1 实现物品数据模型
    - 创建Item实体类和验证规则（包含默认位置字段）
    - 实现物品数据的创建、更新、删除验证逻辑
    - 编写物品模型的单元测试
    - _需求: 1.1, 1.2, 1.3, 1.5_
  
  - [x] 8.2 实现库房位置数据模型
    - 创建Location实体类和验证规则
    - 实现位置层级结构和关联验证逻辑
    - 编写位置模型的单元测试
    - _需求: 7.1, 7.2, 7.3, 7.4, 7.6_

  - [x] 8.3 实现交易记录数据模型
    - 创建Transaction实体类和验证规则（包含位置字段）
    - 实现出入库交易的数据验证和业务规则（包含位置验证）
    - 编写交易模型的单元测试
    - _需求: 2.1, 2.2, 2.5, 3.1, 3.2, 3.5_
  
  - [x] 8.4 实现用户数据模型和认证
    - 创建User实体类和密码哈希处理
    - 实现JWT token生成和验证逻辑
    - 编写用户认证的单元测试
    - _需求: 8.1, 8.2, 8.3, 8.4_

- [x] 9. 库房位置管理API实现
  - 创建位置CRUD的REST API端点
  - 实现位置层级结构查询API
  - 添加位置库存查询和默认位置设置API
  - 编写位置API的集成测试
  - _需求: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_

- [x] 10. 物品管理API实现
  - 创建物品CRUD的REST API端点（支持默认位置）
  - 实现文件上传中间件处理批量导入（支持位置字段）
  - 添加API输入验证和错误处理
  - 编写物品API的集成测试
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5, 6.1, 6.5_

- [x] 11. 出入库API实现
  - 创建出入库操作的REST API端点
  - 实现批量出入库的API接口
  - 添加交易历史查询API
  - 编写出入库API的集成测试
  - _需求: 2.1, 2.2, 2.3, 2.5, 2.6, 3.1, 3.2, 3.4, 3.5, 3.6_

- [x] 12. 库存查询API实现
  - 创建库存查询和搜索的REST API端点
  - 实现低库存预警API
  - 添加库存详情和历史记录API
  - 编写库存API的集成测试
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [-] 13. Excel文件处理功能
  - [x] 13.1 实现Excel解析服务
    - 编写ExcelService类，使用xlsx库解析Excel文件
    - 实现物品、入库、出库数据的Excel解析功能
    - 添加Excel文件格式验证和错误处理
    - 编写Excel解析的单元测试
    - _需求: 2.5, 3.5, 6.1, 6.3_
  
  - [x] 13.2 实现批量导入功能
    - 实现物品信息的批量导入逻辑
    - 实现批量入库和出库操作
    - 添加批量操作的事务处理和错误回滚
    - 编写批量导入的单元测试
    - _需求: 2.5, 2.6, 3.5, 3.6, 6.1, 6.2, 6.4_
  
  - [x] 13.3 实现Excel模板和导出功能
    - 创建标准的Excel导入模板
    - 实现报表数据的Excel导出功能
    - 添加模板下载和导出文件的处理
    - 编写模板和导出的单元测试
    - _需求: 5.3, 6.5_

- [x] 14. 报表统计API实现
  - 创建月度统计和使用排行的API端点
  - 实现报表导出API
  - 添加自定义时间范围统计功能
  - 编写报表API的集成测试
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [x] 15. 认证和权限中间件
  - [x] 15.1 实现JWT认证中间件
    - 创建JWT token验证中间件
    - 实现用户登录和token刷新API
    - 添加token过期和无效处理
    - 编写认证中间件的单元测试
    - _需求: 7.1, 7.4_
  
  - [x] 15.2 实现权限控制中间件
    - 创建基于角色的权限检查中间件
    - 实现管理员和普通员工的权限区分
    - 添加API端点的权限保护
    - 编写权限控制的单元测试
    - _需求: 7.2, 7.3, 7.4_

- [x] 16. 前后端集成
  - 将前端的模拟数据替换为真实API调用
  - 创建HTTP客户端封装（axios）
  - 实现JWT token的自动添加和刷新
  - 测试所有功能的前后端集成
  - _需求: 所有需求的集成测试_

- [ ] 17. 系统测试和优化
  - [x] 17.1 端到端功能测试
    - 编写完整用户流程的E2E测试
    - 测试物品管理、出入库、库存查询的完整流程
    - 验证批量操作和权限控制功能
    - 使用Playwright或Cypress进行自动化测试
    - _需求: 1.1-1.4, 2.1-2.6, 3.1-3.6, 4.1-4.4, 5.1-5.4, 6.1-6.5, 7.1-7.4_
  
  - [ ] 17.2 性能和安全测试
    - 测试大量数据的处理性能
    - 验证文件上传的安全性和限制
    - 测试API的并发处理能力
    - 验证认证和权限控制的安全性
    - _需求: 2.6, 3.6, 6.3, 7.4_

- [x] 18. 部署配置和优化
  - [x] 18.1 创建Docker配置
    - 编写Dockerfile和docker-compose.yml
    - 配置PostgreSQL数据库容器
    - 设置Nginx反向代理配置
    - 创建生产环境的环境变量模板
    - _需求: 所有需求的生产部署_
  
  - [x] 18.2 实现部署脚本和监控
    - 创建自动化部署脚本
    - 实现数据库备份和恢复脚本
    - 添加应用健康检查和日志记录
    - 配置SSL证书和安全设置
    - _需求: 所有需求的运维支持_